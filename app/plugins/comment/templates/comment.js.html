<script>
    $('a.reply-comment').click(function (event) {
        console.log('test');
        event.preventDefault();
        $('#new-comment').detach().insertAfter($(event.target).parent());
        console.log($(event.target));
        $('#comment-parent').val($(event.target).data('parent'));
    });

    function submit_comment(button) {
        button.prop('disabled', true);
        $.ajax({
            beforeSend: function (xhr, settings) {
                xhr.setRequestHeader("X-CSRFToken", "{{ csrf_token() }}");
            },
            type: 'POST',
            url: '{{ url_for('.submit_comment') }}',
            data: {
                meta: JSON.stringify({{ meta|tojson }}),
                parent: $('#comment-parent').val(),
                name: $('#comment-name').val(),
                email: $('#comment-email').val(),
                body: $('#comment-body').val()
            },
            success: function (msg) {
                location.reload();
            }
        });
    }

    $('#comment-submit').click(function (event) {
        submit_comment($(this))
    })
</script>