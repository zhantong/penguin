{% import "_macros.html" as macros %}
<table class="table">
    <thead>
    <tr>
        <th>标题</th>
        <th>作者</th>
        <th>时间</th>
        <th>分类</th>
        <th>标签</th>
        <th>操作</th>
    </tr>
    </thead>
    <tbody>
    {% for repository_id in repository_ids %}
        {% set articles=get_articles(repository_id) %}

        <tr>
            <table class="table">
                <thead>
                <tr>
                    <th>标题</th>
                    <th>作者</th>
                    <th>时间</th>
                    <th>分类</th>
                    <th>标签</th>
                    <th>状态</th>
                    <th>版本时间</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                {% for article in articles %}
                    <tr>
                        <td><a href="{{ url_for('/edit', id=article.id) }}">{{ article.title }}</a></td>
                        <td>{{ article.author.name }}</td>
                        <td>{{ moment(article.timestamp).format('L') }}
                        <td>
                            {% for category in article.categories %}
                                {% set category_info=category.get_info() %}
                                <a href="{{ category_info['url'] }}">{{ category_info['name'] }}</a>
                                {% if not loop.last %}
                                    ,
                                {% endif %}
                            {% endfor %}
                        </td>
                        <td>
                            {% for tag in article.tags %}
                                {% set tag_info=tag.get_info() %}
                                <a href="{{ tag_info['url'] }}">{{ tag_info['name'] }}</a>
                                {% if not loop.last %}
                                    ,
                                {% endif %}
                            {% endfor %}
                        </td>
                        <td>

                            <div class="dropdown">
                                <button class="btn btn-default dropdown-toggle" type="button"
                                        id="dropdown-{{ repository_id }}" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="true">
                                    {{ article.status }}
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu version-dropdown"
                                    aria-labelledby="dropdown-{{ repository_id }}">
                                    <li><a href="#" data-action="publish" data-id="{{ article.id }}">设为发布</a></li>
                                    <li><a href="#" data-action="archive" data-id="{{ article.id }}">设为存档</a></li>
                                    <li><a href="#" data-action="draft" data-id="{{ article.id }}">设为草稿</a></li>
                                    <li><a href="#" data-action="hide" data-id="{{ article.id }}">设为隐藏</a></li>
                                </ul>
                            </div>
                        </td>
                        <td>{{ moment(article.version_timestamp).format('YYYY/MM/DD HH:mm:ss') }}
                        <td>
                            <button type="button" class="btn btn-danger article-item" data-id="{{ article.id }}">删除
                            </button>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% if pagination %}
    <div class="text-center">
        {{ macros.pagination_widget_2(pagination['pagination'],pagination['url_for'], pagination['endpoint'] , **pagination['fragment']) }}
    </div>
{% endif %}